# AI 스토리 영상 생성기

## 🎯 프로젝트 개요
- **이름**: AI 스토리 영상 생성기
- **목표**: 텍스트 스토리를 AI가 분석하여 장면별 이미지를 생성하고 자유롭게 편집 가능
- **상태**: ✅ 작동 중

## ✨ 현재 완성된 기능

### ✅ 전체 워크플로우
1. **스토리 입력** - 텍스트로 스토리 입력
2. **AI 씬 분석** - Gemini API가 스토리를 장면별로 자동 분할
3. **장면 길이 자동 최적화** - 3~10초 범위에서 자동 조절
   - 중요한 장면: 7~10초
   - 짧은 전환 장면: 3~5초
   - 시청자가 지루하지 않도록 최적화
4. **씬 편집 기능** - 각 장면의 설명, 시각적 요소, 길이를 개별 수정 가능
5. **실시간 진행률 표시** - 분석 및 이미지 생성 진행 상황 실시간 확인
6. **이미지 생성** - 각 장면별로 이미지 생성
7. **이미지 프리뷰** - 생성된 이미지를 바로 확인
8. **개별 편집** - 각 이미지를 개별적으로 수정 가능
9. **다운로드** - 개별 또는 전체 ZIP 다운로드
10. **JSON 내보내기** - 프로젝트 전체 데이터 내보내기

## 🌐 URL
**퍼블릭 URL**: https://3000-i56x5nh4xinmzp74cqlq8-5185f4aa.sandbox.novita.ai

## 📊 주요 특징

### 🎬 자동 씬 길이 최적화
- **최소 3초, 최대 10초** 범위에서 자동 조절
- 중요한 장면은 길게 (7~10초)
- 전환 장면은 짧게 (3~5초)
- AI가 스토리의 맥락을 파악하여 최적의 길이 결정
- 시청자가 지루하지 않도록 자연스러운 흐름 유지

### ⚡ 실시간 진행률 표시
- 씬 분석 진행 상황
- 이미지 생성 진행 상황
- 전체 진행률 퍼센트 표시
- 현재 작업 중인 씬 정보

### ✏️ 강력한 편집 기능
- **씬 편집**: 장면 설명, 시각적 요소, 길이 수정
- **이미지 편집**: 생성된 이미지 개별 수정
- **즉시 반영**: 수정 내용 실시간 업데이트

## 📋 사용 방법

### 간단 4단계
1. **스토리 입력**: 텍스트 영역에 전체 스토리 입력
2. **AI 분석**: "AI 씬 분석 시작" 버튼 클릭
3. **씬 확인 및 편집**: 분석된 장면 확인, 필요시 "씬 편집" 버튼으로 수정
4. **이미지 생성**: "이미지 생성 시작" 버튼 클릭
5. **다운로드**: 개별 또는 전체 다운로드

## 🛠️ 기술 스택
- **Backend**: Hono + TypeScript
- **Frontend**: Vanilla JavaScript + TailwindCSS + FontAwesome
- **AI**: Gemini 2.0 Flash API (씬 분석)
- **배포**: Node.js + PM2

## 💻 로컬 개발

```bash
# 의존성 설치
npm install

# 빌드
npm run build

# PM2로 서버 시작
pm2 start ecosystem.config.cjs

# 서버 확인
curl http://localhost:3000
```

## 🔧 개발 명령어

```bash
# 서버 상태 확인
pm2 list

# 로그 확인
pm2 logs webapp --nostream

# 서버 재시작
pm2 restart webapp

# 빌드 및 재시작
npm run build && pm2 restart webapp

# 포트 정리
fuser -k 3000/tcp
```

## 📊 API 엔드포인트

### POST /api/analyze-scenes
스토리를 분석하여 씬 정보를 반환합니다. 각 씬은 3~10초 범위로 자동 최적화됩니다.

**요청**:
```json
{
  "story": "스토리 텍스트"
}
```

**응답**:
```json
{
  "success": true,
  "scenes": [
    {
      "index": 1,
      "description": "씬 설명",
      "visualElements": "시각적 요소",
      "duration": 6,
      "startTime": 0,
      "endTime": 6
    }
  ],
  "totalDuration": 60
}
```

### POST /api/generate-image
각 씬에 대한 이미지를 생성합니다.

**요청**:
```json
{
  "scene": { /* 씬 객체 */ },
  "fullStory": "전체 스토리",
  "sceneIndex": 0,
  "totalScenes": 10
}
```

**응답**:
```json
{
  "success": true,
  "imageUrl": "이미지 URL"
}
```

## 🎨 UI/UX 특징

### 진행 상황 시각화
- **4단계 프로세스 표시**: 현재 어느 단계인지 명확하게 표시
- **실시간 진행률**: 퍼센트와 프로그레스 바로 진행 상황 표시
- **애니메이션 효과**: 부드러운 전환과 로딩 애니메이션

### 편집 모달
- **씬 편집 모달**: 팝업 형태로 모든 씬을 한 번에 편집
- **입력 검증**: 3~10초 범위 내에서만 길이 조절 가능
- **즉시 저장**: 수정 내용 즉시 반영

## 🚀 최신 업데이트

### 2026-01-02: 자동 길이 최적화 시스템
- ✅ 씬 길이 범위를 3~10초로 변경
- ✅ 중요 장면/전환 장면 자동 구분
- ✅ AI가 맥락 파악하여 최적 길이 결정
- ✅ 진행률 표시 시스템 유지
- ✅ 씬 편집 기능 유지
- ✅ 이미지 개별 편집 기능 유지

## 🔑 API 키 설정
`.dev.vars` 파일에 Gemini API 키 설정:
```
GOOGLE_AI_API_KEY=AIzaSyBeJGRWOjxVqUI_cEs99fYjCPAW0Kt0huA
```

## 📝 다음 단계 (선택사항)
- [ ] 실제 이미지 생성 API 통합 (현재는 placeholder)
- [ ] 영상 편집 및 결합 기능
- [ ] 음악/내레이션 추가 기능
- [ ] 클라우드 저장소 연동
- [ ] 협업 기능 추가

## 🐛 트러블슈팅

### 서버가 시작되지 않을 때
```bash
# 포트 정리
fuser -k 3000/tcp

# 빌드 다시
npm run build

# PM2 재시작
pm2 restart webapp
```

### API 키 오류
`.dev.vars` 파일에 올바른 API 키가 설정되어 있는지 확인하세요.

## 📄 라이센스
이 프로젝트는 개인 프로젝트입니다.
